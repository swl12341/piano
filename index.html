<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éŸ³ç©ºæ‰‹èˆ</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>ğŸ­ éŸ³ç©ºæ‰‹èˆ</h1>
        <p>åœ¨ç©ºä¸­ç”¨æ‰‹è·³èˆï¼Œæ¼”å¥å±äºæ‚¨çš„éŸ³ä¹ï¼å°†é£ŸæŒ‡å‚ç›´ç§»åŠ¨æ¥æ§åˆ¶éŸ³è°ƒï¼Œæ„Ÿå—æ‰‹åŠ¿éŸ³ä¹çš„é­…åŠ›ã€‚</p>
        
        <div class="instructions">
            <h3>ğŸ“‹ ä½¿ç”¨è¯´æ˜</h3>
            <ul>
                <li>ç‚¹å‡»"å¼€å§‹æ¼”å¥"æŒ‰é’®</li>
                <li>å…è®¸æµè§ˆå™¨è®¿é—®æ‚¨çš„æ‘„åƒå¤´</li>
                <li>å°†æ‰‹ä¼¸åˆ°æ‘„åƒå¤´å‰</li>
                <li>ç§»åŠ¨é£ŸæŒ‡çš„å‚ç›´ä½ç½®æ¥æ§åˆ¶éŸ³è°ƒ</li>
            </ul>
        </div>
        
        <button id="startButton">å¼€å§‹æ¼”å¥</button>
        
        <div class="canvas-container">
            <canvas id="outputCanvas" width="640" height="480"></canvas>
        </div>
        
        <video id="webcam" style="display: none;"></video>
    </div>

    <!-- å¼•å…¥å¿…è¦çš„åº“ -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
    
    <!-- Tone.js - ä½¿ç”¨å¤šä¸ªCDNä½œä¸ºå¤‡ç”¨ -->
    <script>
        // æ£€æŸ¥Tone.jsæ˜¯å¦åŠ è½½æˆåŠŸ
        function checkToneLoaded() {
            if (typeof Tone === 'undefined') {
                console.error('Tone.js åŠ è½½å¤±è´¥ï¼Œå°è¯•å¤‡ç”¨CDN...');
                loadBackupTone();
            } else {
                console.log('Tone.js åŠ è½½æˆåŠŸ');
            }
        }
        
        function loadBackupTone() {
            const script = document.createElement('script');
            script.src = 'https://unpkg.com/tone@14.7.77/build/Tone.min.js';
            script.onload = () => {
                console.log('å¤‡ç”¨ Tone.js CDN åŠ è½½æˆåŠŸ');
            };
            script.onerror = () => {
                console.error('æ‰€æœ‰ Tone.js CDN éƒ½åŠ è½½å¤±è´¥');
                showLibraryError();
            };
            document.head.appendChild(script);
        }
        
        function showLibraryError() {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'library-error';
            errorDiv.innerHTML = `
                <h3>âš ï¸ åº“åŠ è½½å¤±è´¥</h3>
                <p>æ— æ³•åŠ è½½ Tone.js éŸ³é¢‘åº“ã€‚è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–åˆ·æ–°é¡µé¢é‡è¯•ã€‚</p>
                <button onclick="location.reload()">åˆ·æ–°é¡µé¢</button>
            `;
            document.querySelector('.container').appendChild(errorDiv);
        }
    </script>
    
    <!-- ä¸»è¦ Tone.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/tone@14.7.77/build/Tone.min.js" crossorigin="anonymous"></script>
    
    <!-- å»¶è¿ŸåŠ è½½ä¸»è„šæœ¬ï¼Œç¡®ä¿æ‰€æœ‰åº“éƒ½å·²åŠ è½½ -->
    <script>
        // ç­‰å¾…æ‰€æœ‰åº“åŠ è½½å®Œæˆ
        window.addEventListener('load', () => {
            setTimeout(() => {
                if (typeof Tone !== 'undefined' && typeof Hands !== 'undefined') {
                    console.log('æ‰€æœ‰åº“åŠ è½½å®Œæˆï¼Œå¯åŠ¨åº”ç”¨ç¨‹åº');
                    // åŠ¨æ€åŠ è½½ä¸»è„šæœ¬
                    const script = document.createElement('script');
                    script.src = 'script.js';
                    document.body.appendChild(script);
                } else {
                    console.error('éƒ¨åˆ†åº“æœªåŠ è½½å®Œæˆ');
                    showLibraryError();
                }
            }, 1000);
        });
    </script>
</body>
</html>
